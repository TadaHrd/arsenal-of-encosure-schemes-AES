// Written by TadaHrd.
// If this doesn't work blame him.


let emojiTable = {
    0b0000: ["ðŸ˜€", "ðŸ˜", "ðŸ˜‚", "ðŸ¤£", "ðŸ˜ƒ"],
    0b0001: ["ðŸ˜„", "ðŸ˜…", "ðŸ˜†", "ðŸ˜‰", "ðŸ˜Š"],
    0b0010: ["ðŸ˜‹", "ðŸ˜Ž", "ðŸ˜", "ðŸ˜˜", "ðŸ¥°"],
    0b0011: ["ðŸ˜—", "ðŸ˜™", "ðŸ˜š", "ðŸ¤—", "ðŸ¤©"],
    0b0100: ["ðŸ‘½", "ðŸ¤–", "ðŸ’©", "ðŸ¤“", "ðŸ¦´"],
    0b0101: ["ðŸ¦·", "ðŸ‘", "ðŸ¦ ", "ðŸ§ ", "ðŸ‘€"],
    0b0110: ["ðŸ¢", "ðŸŠ", "ðŸ¦Ž", "ðŸ", "ðŸ‰"],
    0b0111: ["ðŸ—¯", "ðŸ—¨", "ðŸ•™", "ðŸ•ž", "ðŸ’«"],
    0b1000: ["ðŸ•³", "ðŸ“ ", "ðŸ’¯", "ðŸŽˆ", "ðŸŽ¨"],
    0b1001: ["ðŸ”†", "ðŸŽ", "ðŸ§¿", "ðŸš¾", "ðŸ’²"],
    0b1010: ["ðŸŽ‘", "ðŸ–¼", "ðŸ“’", "ðŸ’°", "ðŸŽž"],
    0b1011: ["ðŸ¥½", "ðŸ“Š", "ðŸŽ±", "ðŸ’Ž", "ðŸ’"],
    0b1100: ["ðŸ’»", "ðŸŽŽ", "ðŸŽŸ", "ðŸŽ«", "ðŸ§§"],
    0b1101: ["ðŸ–¥", "ðŸŽƒ", "ðŸŽŠ", "ðŸŽ‰", "ðŸŽ­"],
    0b1110: ["ðŸ§¥", "ðŸ¥¼", "ðŸ–±", "ðŸŽ¹", "ðŸ”¦"],
    0b1111: ["ðŸ“£", "ðŸ”Š", "ðŸ“€", "ðŸ“¸", "ðŸ–‡"],

    "ðŸ˜€":0,"ðŸ˜":0,"ðŸ˜‚":0,"ðŸ¤£":0,"ðŸ˜ƒ":0,
    "ðŸ˜„":1,"ðŸ˜…":1,"ðŸ˜†":1,"ðŸ˜‰":1,"ðŸ˜Š":1,
    "ðŸ˜‹":2,"ðŸ˜Ž":2,"ðŸ˜":2,"ðŸ˜˜":2,"ðŸ¥°":2,
    "ðŸ˜—":3,"ðŸ˜™":3,"ðŸ˜š":3,"ðŸ¤—":3,"ðŸ¤©":3,
    "ðŸ‘½":4,"ðŸ¤–":4,"ðŸ’©":4,"ðŸ¤“":4,"ðŸ¦´":4,
    "ðŸ¦·":5,"ðŸ‘":5,"ðŸ¦ ":5,"ðŸ§ ":5,"ðŸ‘€":5,
    "ðŸ¢":6,"ðŸŠ":6,"ðŸ¦Ž":6,"ðŸ":6,"ðŸ‰":6,
    "ðŸ—¯":7,"ðŸ—¨":7,"ðŸ•™":7,"ðŸ•ž":7,"ðŸ’«":7,
    "ðŸ•³":8,"ðŸ“ ":8,"ðŸ’¯":8,"ðŸŽˆ":8,"ðŸŽ¨":8,
    "ðŸ”†":9,"ðŸŽ":9,"ðŸ§¿":9,"ðŸš¾":9,"ðŸ’²":9,
    "ðŸŽ‘":10,"ðŸ–¼":10,"ðŸ“’":10,"ðŸ’°":10,"ðŸŽž":10,
    "ðŸ¥½":11,"ðŸ“Š":11,"ðŸŽ±":11,"ðŸ’Ž":11,"ðŸ’":11,
    "ðŸ’»":12,"ðŸŽŽ":12,"ðŸŽŸ":12,"ðŸŽ«":12,"ðŸ§§":12,
    "ðŸ–¥":13,"ðŸŽƒ":13,"ðŸŽŠ":13,"ðŸŽ‰":13,"ðŸŽ­":13,
    "ðŸ§¥":14,"ðŸ¥¼":14,"ðŸ–±":14,"ðŸŽ¹":14,"ðŸ”¦":14,
    "ðŸ“£":15,"ðŸ”Š":15,"ðŸ“€":15,"ðŸ“¸":15,"ðŸ–‡":15,
}

function emoji_encode(input) {
    let data;
    if (typeof input == "string")
        data = textEncoder.encode(input);
    else
        data = input;

    let ret = "";
    for (let val of data) {
        let nibble0 = (val >> 0) & 0b1111;
        let nibble1 = (val >> 4) & 0b1111;

        ret += emojiTable[nibble1][rand(4)];
        ret += emojiTable[nibble0][rand(4)];
    }

    return ret;
}

function emoji_decode(text, return_string) {
    let ret = [];

    for (let i = 0; i < text.length; i += 4) {
        let v0 = text[i];
        let v1 = text[i + 1];
        let v2 = text[i + 2];
        let v3 = text[i + 3];

        let nibble0 = emojiTable[v0 + v1];
        let nibble1 = emojiTable[v2 + v3];

        let num = nibble1 + (nibble0 << 4);

        ret.push(num);
    }

    if (return_string)
        return textDecoder.decode(new Uint8Array(ret))

    return ret;
}